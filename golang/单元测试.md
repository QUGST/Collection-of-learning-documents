# 1.单元测试场景
对于一个传统的后端服务，它主要有以下几点的职责和功能：

- 接收外部请求，controller 层分发请求、校验请求参数  
    
- 请求有效分发后，在 service 层与 dao 层进行交互后做逻辑处理  
    
- dao 层负责数据操作，主要是数据库或持久化存储相关的操作  
    

因此，从职责出发来看，在做后台单测中，核心主要是验证 service 层和 dao 层的相关逻辑，此外 controller 层的参数校验也在单测之中。

细分来看，对于相关逻辑的单元测试，笔者倾向于把单测分为两种：

- 无第三方依赖，纯逻辑代码  
    
- 有第三方依赖，如文件、网络 I/O、第三方依赖库、数据库操作相关的代码
**单元测试中只是针对单个函数的测试，关注其内部的逻辑，对于网络/数据库访问等，需要通过相应的手段进行 mock.**  
# 单元测试工具
1.  对于无第三方依赖的纯逻辑代码，我们只需要验证**相关逻辑**即可，这里只需要使用 `assert`**（断言）**，通过控制输入输出比对结果即可。  可以选择 testify 或 convery
    
2. 对于有第三方依赖的代码，在验证相关代码逻辑之前，我们需要将相关的依赖 `mock`**（模拟）**，之后才能通过断言验证逻辑。这里需要借助第三方工具库来处理。使用 gomock 和 gomonkey
# 流程
### **1. 生成单测模板代码**
首先在 Goland 中打开项目，加载对应文件后右键找到 Generate 项，点击后选择 Tests for package，之后生成以 `_test.go` 结尾的单测文件。（如果想针对某一特定函数做单测，请选择对应的函数后右键选定 Generate 项执行 Tests for selection。）